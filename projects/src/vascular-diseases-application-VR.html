<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vascular Diseases VR</title>
    <link rel="stylesheet" href="../../css/w3.css">

    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>

    <!-- Library of Virtual Reality -->
    <script type="text/javascript" charset="UTF-8" src="../libs/aframe-master.js"></script>
    <script type="text/javascript" charset="UTF-8" src="../libs/other/vr-interface.js"></script>

    <script>
        AFRAME.registerComponent('config', {
            init: function () {
                const self = this;
                // const vrInterface = document.querySelector('[vr-interface]').components["vr-interface"];
                const vrInterface = this.el.components['vr-interface'];

                this.models = document.querySelectorAll('.menu-model');
                this.modelIndex = 0;

                vrInterface.addButton('next', '#next', () => {
                    self.models[self.modelIndex].object3D.visible = false;

                    if (self.modelIndex == self.models.length - 1) {
                        self.modelIndex = 0;
                    }
                    else {
                        self.modelIndex++;
                    }

                    self.models[self.modelIndex].object3D.visible = true;
                });

                vrInterface.addButton('rotLeft', '#rotLeft', () => {
                    self.models[self.modelIndex].object3D.rotation.y -= Math.PI * 0.25;
                });

                vrInterface.addButton('rotRight', '#rotRight', () => {
                    self.models[self.modelIndex].object3D.rotation.y += Math.PI * 0.25;
                });

                vrInterface.addButton('zoomIn', '#zoomIn', () => {
                    if (self.models[self.modelIndex].object3D.position.z < - 1.2) {
                        self.models[self.modelIndex].object3D.position.z += 0.8;
                    }
                });

                vrInterface.addButton('zoomOut', '#zoomOut', () => {
                    if (self.models[self.modelIndex].object3D.position.z > -2.4) {
                        self.models[self.modelIndex].object3D.position.z -= 0.8;
                    }
                });
            }
        });
    </script>
</head>

<body>
    <a-scene main_scene id="scene" background="color: #323232" gltf-model="dracoDecoderPath: ../libs/draco/gltf/;">
        <a-assets timeout="3000">
            <a-asset-item id="strokeModel" src="assets/models/vascular-diseases/stroke.glb"></a-asset-item>
            <a-asset-item id="aneurismModel" src="assets/models/vascular-diseases/an.glb"></a-asset-item>
            <a-asset-item id="stenosisModel" src="assets/models/vascular-diseases/stenosis.glb"></a-asset-item>
            <a-asset-item id="thrombusModel" src="assets/models/vascular-diseases/th.glb"></a-asset-item>

            <img id="next" src="assets/icons/next.png">
            <img id="rotLeft" src="assets/icons/rotleft.png">
            <img id="rotRight" src="assets/icons/rotright.png">
            <img id="zoomIn" src="assets/icons/zooin.png">
            <img id="zoomOut" src="assets/icons/zoomout.png">
        </a-assets>

        <a-entity light="type: ambient; color: #fff; intensity: 0.3"></a-entity>
        <a-entity light="type: point; color: #fff; intensity: 0.7" position="0 1.6 0"></a-entity>
        <a-entity light="color: #fff" position="-5 110 0"></a-entity>

        <a-entity id="stroke" class="menu-model" position="0 2 -2" scale="0.01 0.01 0.01" gltf-model="#strokeModel"
            visible="true">
        </a-entity>
        <a-entity id="aneurism" class="menu-model" position="-1 0 -2" gltf-model="#aneurismModel" visible="false">
        </a-entity>
        <a-entity id="stenosis" class="menu-model" position="0 1 -2" scale="0.02 0.02 0.02" gltf-model="#stenosisModel"
            visible="false">
        </a-entity>
        <a-entity id="thrombus" class="menu-model" position="0 1.5 -2" scale="10 10 10" rotation="0 -10 0"
            gltf-model="#thrombusModel" visible="false">
        </a-entity>

        <a-plane position="0 0 0" rotation="-90 0 0" width="20" height="20" color="#666666"></a-plane>

        <a-entity id="rig" position="0 0 0" rotation="0 0 0">
            <a-entity id="camera" camera position="0 1.6 0" look-controls="pointerLockEnabled: true">
            </a-entity>
        </a-entity>

        <a-entity vr-interface="position: -1 0 0; dimension: 5 1; centralize: true;" config></a-entity>

    </a-scene>
</body>

</html>